(function(){class H{constructor(){this.refreshAll(),this.refreshInterval=setInterval(()=>this.refreshAll(),6e4),document.addEventListener("geodir_map_infowindow_open",()=>setTimeout(()=>this.refreshAll(),50)),document.addEventListener("geodir_content_updated",()=>setTimeout(()=>this.refreshAll(),50))}refreshAll(){document.querySelectorAll(".gd-bh-show-field").forEach(e=>this.refreshField(e))}refreshField(e){const i=e.querySelector(".gd-bh-expand-range");if(!i)return;const A=parseInt(i.dataset.offsetsec||"0"),v=new Date,y=new Date(v.getTime()+v.getTimezoneOffset()*6e4+A*1e3),p=this.pad(y.getHours(),2)+this.pad(y.getMinutes(),2);let f=y.getDay()||7;e.dataset.t=p,i.dataset.date=y.toISOString().slice(0,19);const t=e.querySelector(`[data-day="${f}"]`),_=f>1?f-1:7,a=e.querySelector(`[data-day="${_}"]`);let o=!1,r=[],g=[];if(e.classList.remove("gd-bh-open","gd-bh-close"),e.querySelectorAll("div").forEach(s=>{s.classList.remove("gd-bh-open","gd-bh-close","gd-bh-days-open","gd-bh-days-close","gd-bh-slot-open","gd-bh-slot-close","gd-bh-days-today","gd-bh-days-prevday","active")}),a?.querySelector(".gd-bh-next-day")){a.classList.add("gd-bh-days-prevday");const s=a.querySelector(".gd-bh-days-d")?.textContent||"";a.querySelectorAll(".gd-bh-slot").forEach(n=>{const d=n.dataset.open&&n.dataset.close&&parseInt(p)<=parseInt(n.dataset.close),u=n.querySelector(".gd-bh-slot-r")?.innerHTML||"";n.classList.add(d?"gd-bh-slot-open":"gd-bh-slot-close"),d&&(o=!0,g.push(s+" "+u)),r.push(s+" "+u)}),a.classList.add(o?"gd-bh-days-open":"gd-bh-days-close"),o&&(r=g);const l=e.querySelector(".gd-bh-today-range");l&&(l.innerHTML=r.join(", "))}let h=!1,S=!1;if(t){t.classList.add("gd-bh-days-today");const s=t.querySelector(".gd-bh-days-d")?.textContent||"",l=o&&s?s+" ":"";o||(r=[],g=[]),t.dataset.closed!=="1"?t.querySelectorAll(".gd-bh-slot").forEach(d=>{const u=parseInt(d.dataset.open),x=parseInt(d.dataset.close),T=d.classList.contains("gd-bh-next-day"),q=d.querySelector(".gd-bh-slot-r")?.innerHTML||"",D=parseInt(p),E=u&&x&&u<=D&&(D<=x||T);d.classList.add(E?"gd-bh-slot-open":"gd-bh-slot-close"),E&&(h=!0,g.push(l+q)),(o&&h||!o)&&r.push(l+q)}):S=!0,t.classList.add(h?"gd-bh-days-open":"gd-bh-days-close"),h&&(r=g);const n=e.querySelector(".gd-bh-today-range");n&&(n.innerHTML=[...new Set(r)].join(", "))}const L=window.geodir_params||{},c=h||o,C=c?L.txt_open_now||"Open now":S?L.txt_closed_today||"Closed today":L.txt_closed_now||"Closed now";e.classList.add(c?"gd-bh-open":"gd-bh-close");const m=e.querySelector(".geodir-i-biz-hours"),w=e.querySelector(".geodir-i-biz-hours font"),I=c?"text-success":"text-danger",O=c?"text-danger":"text-success";if(m&&(m.classList.add(I),m.classList.remove(O)),w&&(w.textContent=C),e.querySelectorAll(".gd-bh-slot-open .gd-bh-slot-r").forEach(s=>{s.classList.add("text-success"),s.classList.remove("text-danger")}),e.querySelectorAll(".gd-bh-slot-close .gd-bh-slot-r").forEach(s=>{s.classList.add("text-danger"),s.classList.remove("text-success")}),t?.classList.contains("gd-bh-days-list")){const s=c?"bg-success-subtle":"bg-danger-subtle",l=c?"bg-danger-subtle":"bg-success-subtle";t.classList.add(s),t.classList.remove(l)}o&&a?.classList.contains("gd-bh-days-list")&&(a.classList.add("bg-success-subtle"),a.classList.remove("bg-danger-subtle"))}pad(e,i){return String(e).padStart(i,"0")}destroy(){clearInterval(this.refreshInterval)}}function M(){return document.querySelector(".gd-bh-show-field")?new H:null}window.GeoDir=window.GeoDir||{};document.addEventListener("alpine:init",()=>{console.log("GeoDirectory: Alpine initialized")});document.addEventListener("DOMContentLoaded",()=>{console.log("GeoDirectory: Frontend DOM loaded");const b=M();b&&(window.GeoDir.businessHoursDisplay=b,console.log("GeoDirectory: Business hours display initialized"))});
//# sourceMappingURL=geodir-frontend.js.map
})();