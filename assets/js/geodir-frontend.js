(function(){class T{constructor(){this.refreshAll(),this.refreshInterval=setInterval(()=>this.refreshAll(),6e4),document.addEventListener("geodir_map_infowindow_open",()=>setTimeout(()=>this.refreshAll(),50)),document.addEventListener("geodir_content_updated",()=>setTimeout(()=>this.refreshAll(),50))}refreshAll(){document.querySelectorAll(".gd-bh-show-field").forEach(e=>this.refreshField(e))}refreshField(e){const d=e.querySelector(".gd-bh-expand-range");if(!d)return;const y=parseInt(d.dataset.offsetsec||"0"),c=new Date,g=new Date(c.getTime()+c.getTimezoneOffset()*6e4+y*1e3),n=this.pad(g.getHours(),2)+this.pad(g.getMinutes(),2);let i=g.getDay()||7;e.dataset.t=n,d.dataset.date=g.toISOString().slice(0,19);const r=e.querySelector(`[data-day="${i}"]`),x=i>1?i-1:7,s=e.querySelector(`[data-day="${x}"]`);let t=!1,a=[],h=[];if(e.classList.remove("gd-bh-open","gd-bh-close"),e.querySelectorAll("div").forEach(o=>{o.classList.remove("gd-bh-open","gd-bh-close","gd-bh-days-open","gd-bh-days-close","gd-bh-slot-open","gd-bh-slot-close","gd-bh-days-today","gd-bh-days-prevday","active")}),s?.querySelector(".gd-bh-next-day")){s.classList.add("gd-bh-days-prevday");const o=s.querySelector(".gd-bh-days-d")?.textContent||"";s.querySelectorAll(".gd-bh-slot").forEach(p=>{const b=p.dataset.open&&p.dataset.close&&parseInt(n)<=parseInt(p.dataset.close),S=p.querySelector(".gd-bh-slot-r")?.innerHTML||"";p.classList.add(b?"gd-bh-slot-open":"gd-bh-slot-close"),b&&(t=!0,h.push(o+" "+S)),a.push(o+" "+S)}),s.classList.add(t?"gd-bh-days-open":"gd-bh-days-close"),t&&(a=h);const v=e.querySelector(".gd-bh-today-range");v&&(v.innerHTML=a.join(", "))}let u=!1,l=!1;if(r){r.classList.add("gd-bh-days-today");const o=r.querySelector(".gd-bh-days-d")?.textContent||"",v=t&&o?o+" ":"";t||(a=[],h=[]),r.dataset.closed!=="1"?r.querySelectorAll(".gd-bh-slot").forEach(b=>{const S=parseInt(b.dataset.open),D=parseInt(b.dataset.close),O=b.classList.contains("gd-bh-next-day"),A=b.querySelector(".gd-bh-slot-r")?.innerHTML||"",E=parseInt(n),C=S&&D&&S<=E&&(E<=D||O);b.classList.add(C?"gd-bh-slot-open":"gd-bh-slot-close"),C&&(u=!0,h.push(v+A)),(t&&u||!t)&&a.push(v+A)}):l=!0,r.classList.add(u?"gd-bh-days-open":"gd-bh-days-close"),u&&(a=h);const p=e.querySelector(".gd-bh-today-range");p&&(p.innerHTML=[...new Set(a)].join(", "))}const f=window.geodir_params||{},L=u||t,M=L?f.txt_open_now||"Open now":l?f.txt_closed_today||"Closed today":f.txt_closed_now||"Closed now";e.classList.add(L?"gd-bh-open":"gd-bh-close");const w=e.querySelector(".geodir-i-biz-hours"),q=e.querySelector(".geodir-i-biz-hours font"),_=L?"text-success":"text-danger",R=L?"text-danger":"text-success";if(w&&(w.classList.add(_),w.classList.remove(R)),q&&(q.textContent=M),e.querySelectorAll(".gd-bh-slot-open .gd-bh-slot-r").forEach(o=>{o.classList.add("text-success"),o.classList.remove("text-danger")}),e.querySelectorAll(".gd-bh-slot-close .gd-bh-slot-r").forEach(o=>{o.classList.add("text-danger"),o.classList.remove("text-success")}),r?.classList.contains("gd-bh-days-list")){const o=L?"bg-success-subtle":"bg-danger-subtle",v=L?"bg-danger-subtle":"bg-success-subtle";r.classList.add(o),r.classList.remove(v)}t&&s?.classList.contains("gd-bh-days-list")&&(s.classList.add("bg-success-subtle"),s.classList.remove("bg-danger-subtle"))}pad(e,d){return String(e).padStart(d,"0")}destroy(){clearInterval(this.refreshInterval)}}function G(){return document.querySelector(".gd-bh-show-field")?new T:null}function I(){const m=document.querySelectorAll(".gd-rating-input");m.length&&m.forEach(e=>{const d=e.querySelector(".gd-rating-wrap"),y=e.querySelector(".gd-rating-foreground"),c=e.querySelector(".gd-rating-text"),g=e.querySelector('input[type="hidden"]'),n=e.querySelectorAll(".gd-rating-foreground > i, .gd-rating-foreground > svg, .gd-rating-foreground > img");if(!d||!y||!c||!g||!n.length)return;const i=n.length,r=parseFloat(g.value)||0;if(y.style.pointerEvents="none",r>0){const s=r/i*100;y.style.width=`${s}%`;const t=Math.floor(r)-1;n[t]&&(c.textContent=n[t].getAttribute("title")||"")}let x=!1;d.addEventListener("mousemove",s=>{const t=d.getBoundingClientRect(),a=s.clientX-t.left,h=t.width/i,u=Math.floor(a/h),l=Math.min(Math.max(u+1,1),i),f=l/i*100;y.style.width=`${f}%`,n[l-1]&&(c.textContent=n[l-1].getAttribute("title")||""),x=!1}),d.addEventListener("mouseleave",()=>{if(!x){const s=parseFloat(g.value)||0,t=s/i*100;if(y.style.width=`${t}%`,s>0){const a=Math.floor(s)-1;n[a]&&(c.textContent=n[a].getAttribute("title")||"")}else c.textContent=c.getAttribute("data-title")||""}x=!1}),d.addEventListener("click",s=>{const t=d.getBoundingClientRect(),a=s.clientX-t.left,h=t.width/i,u=Math.floor(a/h),l=Math.min(Math.max(u+1,1),i),f=l/i*100;g.value=l,y.style.width=`${f}%`,n[l-1]&&(c.textContent=n[l-1].getAttribute("title")||""),x=!0})})}window.GeoDir=window.GeoDir||{};document.addEventListener("alpine:init",()=>{console.log("GeoDirectory: Alpine initialized")});document.addEventListener("DOMContentLoaded",()=>{console.log("GeoDirectory: Frontend DOM loaded");const m=G();m&&(window.GeoDir.businessHoursDisplay=m,console.log("GeoDirectory: Business hours display initialized")),I(),window.GeoDir.initRatingInput=I,console.log("GeoDirectory: Rating input initialized")});
//# sourceMappingURL=geodir-frontend.js.map
})();