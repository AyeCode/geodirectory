(function(root, factory) {
	if (typeof define === 'function' && define.amd) {
		define([], factory);
	} else if (typeof module === 'object' && module.exports) {
		module.exports = factory();
	} else {
		class m{constructor(e,t={}){this.elementId=e,this.options=t,this.map=null,this.markers=[]}init(){throw new Error("MapProvider.init() must be implemented by subclass")}createMarker(e){throw new Error("MapProvider.createMarker() must be implemented by subclass")}getCenter(){throw new Error("MapProvider.getCenter() must be implemented by subclass")}setCenter(e,t){throw new Error("MapProvider.setCenter() must be implemented by subclass")}panTo(e,t){throw new Error("MapProvider.panTo() must be implemented by subclass")}getZoom(){throw new Error("MapProvider.getZoom() must be implemented by subclass")}setZoom(e){throw new Error("MapProvider.setZoom() must be implemented by subclass")}geocode(e){throw new Error("MapProvider.geocode() must be implemented by subclass")}reverseGeocode(e,t){throw new Error("MapProvider.reverseGeocode() must be implemented by subclass")}addEventListener(e,t){throw new Error("MapProvider.addEventListener() must be implemented by subclass")}getType(){return this.mapType}isReady(){return this.map!==null}}class g extends m{constructor(e,t={}){super(e,t),this.mapType="google",this.geocoder=null}init(){if(console.log("[GoogleMapProvider] Initializing for element:",this.elementId),console.log("[GoogleMapProvider] Options:",this.options),!window.google||!google.maps)return console.error("[GoogleMapProvider] Google Maps not loaded"),!1;console.log("[GoogleMapProvider] Google Maps API is available"),this.geocoder=new google.maps.Geocoder,console.log("[GoogleMapProvider] Geocoder initialized");const e=document.getElementById(this.elementId);if(console.log("[GoogleMapProvider] Map element:",e),!e)return console.error(`[GoogleMapProvider] Map element #${this.elementId} not found`),!1;const t=this.options.maptype&&google.maps.MapTypeId[this.options.maptype]||google.maps.MapTypeId.ROADMAP;return console.log("[GoogleMapProvider] Creating map with options:",{center:{lat:this.options.latitude||0,lng:this.options.longitude||0},zoom:this.options.zoom||12,mapTypeId:t}),this.map=new google.maps.Map(e,{center:{lat:parseFloat(this.options.latitude)||0,lng:parseFloat(this.options.longitude)||0},zoom:parseInt(this.options.zoom)||12,mapTypeId:t,streetViewControl:this.options.streetViewControl!==!1,scrollwheel:this.options.scrollwheel!==!1,...this.options.mapOptions}),console.log("[GoogleMapProvider] Map initialized:",this.map?"SUCCESS":"FAILED"),!0}createMarker(e){const t=parseFloat(e.lat||e.latitude)||0,r=parseFloat(e.lng||e.longitude)||0,o={position:{lat:t,lng:r},map:this.map,draggable:e.draggable!==!1,title:e.title||""};if(e.icon){const a={url:e.icon};e.w&&e.h&&(a.scaledSize=new google.maps.Size(parseInt(e.w),parseInt(e.h)),a.anchor=new google.maps.Point(parseInt(e.w)/2,parseInt(e.h))),o.icon=a}const i=new google.maps.Marker(o);return this.markers.push(i),i}getCenter(){if(!this.map)return null;const e=this.map.getCenter();return{lat:e.lat(),lng:e.lng()}}setCenter(e,t){this.map&&this.map.setCenter(new google.maps.LatLng(e,t))}panTo(e,t){this.map&&this.map.panTo(new google.maps.LatLng(e,t))}getZoom(){return this.map?this.map.getZoom():null}setZoom(e){this.map&&this.map.setZoom(e)}geocode(e){return new Promise((t,r)=>{if(!this.geocoder){r(new Error("Geocoder not initialized"));return}const o=typeof e=="string"?{address:e}:e;this.geocoder.geocode(o,(i,a)=>{a===google.maps.GeocoderStatus.OK?t(i):r(new Error(`Geocoding failed: ${a}`))})})}reverseGeocode(e,t){return new Promise((r,o)=>{if(!this.geocoder){o(new Error("Geocoder not initialized"));return}this.geocoder.geocode({latLng:new google.maps.LatLng(e,t)},(i,a)=>{a===google.maps.GeocoderStatus.OK?r(i):o(new Error(`Reverse geocoding failed: ${a}`))})})}addEventListener(e,t){if(!this.map)return;const o={dragend:"dragend",zoom_changed:"zoom_changed",click:"click"}[e]||e;google.maps.event.addListener(this.map,o,t)}addMarkerListener(e,t,r){e&&google.maps.event.addListener(e,t,r)}}class p extends m{constructor(e,t={}){super(e,t),this.mapType="osm"}init(){return!window.L||!L.version?(console.error("Leaflet not loaded"),!1):document.getElementById(this.elementId)?(this.map=L.map(this.elementId,{center:[parseFloat(this.options.latitude)||0,parseFloat(this.options.longitude)||0],zoom:parseInt(this.options.zoom)||12,scrollWheelZoom:this.options.scrollwheel!==!1,...this.options.mapOptions}),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(this.map),!0):(console.error(`Map element #${this.elementId} not found`),!1)}createMarker(e){const t=parseFloat(e.lat||e.latitude)||0,r=parseFloat(e.lng||e.longitude)||0,o={draggable:e.draggable!==!1,title:e.title||""};if(e.icon){const a={iconUrl:e.icon};e.w&&e.h&&(a.iconSize=[parseInt(e.w),parseInt(e.h)],a.iconAnchor=[parseInt(e.w)/2,parseInt(e.h)],a.popupAnchor=[0,-parseInt(e.h)]),o.icon=L.icon(a)}const i=L.marker([t,r],o).addTo(this.map);return this.markers.push(i),i}getCenter(){if(!this.map)return null;const e=this.map.getCenter();return{lat:e.lat,lng:e.lng}}setCenter(e,t){this.map&&this.map.setView([e,t])}panTo(e,t){this.map&&this.map.panTo(new L.LatLng(e,t))}getZoom(){return this.map?this.map.getZoom():null}setZoom(e){this.map&&this.map.setZoom(e)}async geocode(e){const t=typeof e=="string"?e:e.address,r=e.country||"";if(!t)throw new Error("Address is required for geocoding");try{const o=new URLSearchParams({q:t,format:"json",addressdetails:"1",limit:"1"});return r&&o.append("countrycodes",r.toLowerCase()),(await(await fetch(`https://nominatim.openstreetmap.org/search?${o}`)).json()).map(c=>this.normalizeOSMResult(c))}catch(o){throw new Error(`OSM Geocoding failed: ${o.message}`)}}async reverseGeocode(e,t){try{const r=new URLSearchParams({lat:e.toString(),lon:t.toString(),format:"json",addressdetails:"1"}),i=await(await fetch(`https://nominatim.openstreetmap.org/reverse?${r}`)).json();return[this.normalizeOSMResult(i)]}catch(r){throw new Error(`OSM Reverse geocoding failed: ${r.message}`)}}normalizeOSMResult(e){const t=e.address||{};return{display_address:e.display_name,lat:parseFloat(e.lat),lon:parseFloat(e.lon),postcode:t.postcode||"",city:t.city||t.town||t.village||"",state:t.state||"",country:t.country||"",country_code:t.country_code?t.country_code.toUpperCase():"",address:t,gb_country:this.getGBCountry(t)}}getGBCountry(e){if(e.country_code!=="gb")return null;const t=e.state||"",r=["England","Northern Ireland","Scotland","Wales"];for(const o of r)if(t.includes(o))return o;return null}addEventListener(e,t){if(!this.map)return;const o={dragend:"dragend",zoom_changed:"zoomend",click:"click"}[e]||e;this.map.on(o,t)}addMarkerListener(e,t,r){e&&e.on(t,r)}}class n{static create(e,t={}){console.log("[MapFactory] Creating map provider for element:",e),console.log("[MapFactory] Options:",t);const r=t.preferredProvider||n.detectProvider();switch(console.log("[MapFactory] Detected/preferred provider:",r),console.log("[MapFactory] Google available?",n.isGoogleMapsAvailable()),console.log("[MapFactory] OSM available?",n.isOSMAvailable()),r){case"google":if(n.isGoogleMapsAvailable())return console.log("[MapFactory] Creating GoogleMapProvider"),new g(e,t);if(console.warn("[MapFactory] Google Maps not available, falling back to OSM"),n.isOSMAvailable())return console.log("[MapFactory] Creating OSMMapProvider (fallback)"),new p(e,t);break;case"osm":if(n.isOSMAvailable())return console.log("[MapFactory] Creating OSMMapProvider"),new p(e,t);if(console.warn("[MapFactory] OSM not available, falling back to Google Maps"),n.isGoogleMapsAvailable())return console.log("[MapFactory] Creating GoogleMapProvider (fallback)"),new g(e,t);break;case"auto":default:if(n.isGoogleMapsAvailable())return console.log("[MapFactory] Creating GoogleMapProvider (auto)"),new g(e,t);if(n.isOSMAvailable())return console.log("[MapFactory] Creating OSMMapProvider (auto)"),new p(e,t);break}return console.error("[MapFactory] No map provider available!"),null}static detectProvider(){if(console.log("[MapFactory] Detecting provider... window.gdSetMap:",window.gdSetMap),window.gdSetMap){if((window.gdSetMap==="google"||window.gdSetMap==="auto")&&n.isGoogleMapsAvailable())return console.log("[MapFactory] Using Google Maps (from gdSetMap)"),"google";if((window.gdSetMap==="osm"||window.gdSetMap==="auto")&&n.isOSMAvailable())return console.log("[MapFactory] Using OSM (from gdSetMap)"),"osm"}return n.isGoogleMapsAvailable()?(console.log("[MapFactory] Auto-detected Google Maps"),"google"):n.isOSMAvailable()?(console.log("[MapFactory] Auto-detected OSM"),"osm"):(console.log("[MapFactory] No provider detected"),"none")}static isGoogleMapsAvailable(){return!!(window.google&&typeof google.maps<"u")}static isOSMAvailable(){return!!(window.L&&typeof L.version<"u")}static getAvailableProvider(){return n.detectProvider()}}class s{static regionLevel2Countries=["GB","ES"];static citySpecialCases=["IE","TR","FR"];static regionOverrides={IM:"Isle of Man",SG:"Singapore",VA:"Vatican City State"};static regionFixes={"Brussels Hoofdstedelijk Gewest":"Brussels"};static gbRegionFixes={"Stoke-on-Trent":"Staffordshire"};static parseAddress(e,t={}){return!e||e.length===0?null:(t.mapType||"google")==="osm"?s.parseOSMAddress(e[0]):s.parseGoogleAddress(e)}static parseOSMAddress(e){return{street:e.display_address||"",street2:s.getStreet2FromOSM(e),zip:e.postcode||"",city:e.city||"",region:e.state||"",country:e.country||"",countryISO:e.country_code||"",baseCountry:e.gb_country?e.country:""}}static getStreet2FromOSM(e){const t=e.address||{};return t.building?t.building:t.department_store?t.department_store:t.hotel?t.hotel:""}static parseGoogleAddress(e){const t={street:"",street2:"",zip:"",city:"",region:"",country:"",countryISO:"",baseCountry:""},r=s.extractComponents(e);t.country=r.country.long_name||"",t.countryISO=r.country.short_name||"";const o=s.parseStreet(e[0],r);if(t.street=o.street,t.street2=o.street2,t.region=s.parseRegion(r,t.countryISO),t.city=s.parseCity(r,t.countryISO),t.zip=s.parseZip(e,r,t.region),t.countryISO==="GB"&&s.isGBSplitEnabled()){const i=s.getGBCountry(r);i&&(t.baseCountry=t.country,t.country=i)}return t.city==="Vatican City"&&(t.countryISO="VA",t.region="Vatican City State",t.country="Holy See"),t}static extractComponents(e){const t={street_number:{},route:{},premise:{},establishment:{},administrative_area_level_1:{},administrative_area_level_2:{},administrative_area_level_3:{},sublocality_level_1:{},postal_town:{},locality:{},sublocality:{},country:{},postal_code:{},postal_code_prefix:{}};return e.forEach(r=>{r.types&&r.types[0]==="locality"&&r.address_components.forEach(o=>{(o.types||[]).forEach(a=>{t.hasOwnProperty(a)&&!t[a].long_name&&(t[a]=o)})})}),e[0]&&e[0].address_components&&e[0].address_components.forEach(r=>{const o=r.types||[];o.forEach(i=>{t.hasOwnProperty(i)&&!t[i].long_name&&(t[i]=r),(i==="sublocality"||o[1]==="sublocality")&&(t.sublocality.long_name||(t.sublocality=r))})}),t}static parseStreet(e,t){let r="",o="";const i=e.formatted_address||"",a=i.split(",",2);return a.length>1&&(r=s.parseStreetFromFormatted(a,t)),(!r||r==="none")&&(t.establishment.long_name&&a[1]?(r=a[1],o=a[0]):r==="none"&&(r=a[0]||"")),r||(t.street_number.long_name&&(r+=t.street_number.long_name+" "),t.route.long_name&&(r+=t.route.long_name)),!o&&t.premise.long_name&&t.premise.long_name!==r&&(o=t.premise.long_name),t.country.short_name==="JP"&&i&&(r=s.parseJapaneseStreet(i,t)),{street:r.trim(),street2:o.trim()}}static parseStreetFromFormatted(e,t){const r=[{component:"street_number",field:"long_name"},{component:"street_number",field:"short_name"},{component:"premise",field:"long_name"},{component:"premise",field:"short_name"}];for(const o of r){const i=t[o.component][o.field];if(i){if(i.toLowerCase()===e[0].toLowerCase().trim())return i+", "+e[1];if(i.toLowerCase()===e[1].toLowerCase().trim())return e[0]+", "+i}}return"none"}static parseJapaneseStreet(e,t){if((window.mapLang||"")!=="ja")return"";let o=e.replace(t.country.long_name+"、","");t.postal_code.long_name&&(o=o.replace(t.country.long_name+" 〒"+t.postal_code.long_name,"〒"+t.postal_code.long_name),o=o.replace("〒"+t.postal_code.long_name+" ",""));let i=[];return t.locality.long_name&&o.includes(t.locality.long_name)?i=o.split(t.locality.long_name):t.administrative_area_level_1.long_name&&o.includes(t.administrative_area_level_1.long_name)&&(i=o.split(t.administrative_area_level_1.long_name)),i.length>1?i[i.length-1]:o}static parseRegion(e,t){let r="";return s.regionOverrides[t]?s.regionOverrides[t]:(s.regionLevel2Countries.includes(t)?r=e.administrative_area_level_2.long_name||e.administrative_area_level_1.long_name||"":r=e.administrative_area_level_1.long_name||e.administrative_area_level_2.long_name||"",t==="GR"&&!r&&e.administrative_area_level_3.long_name&&(r=e.administrative_area_level_3.long_name),t==="GB"&&(s.gbRegionFixes[r]&&(r=s.gbRegionFixes[r]),r=r.replace(" Council","")),s.regionFixes[r]&&(r=s.regionFixes[r]),r)}static parseCity(e,t){if(t==="BB"&&!e.locality.long_name&&e.sublocality.long_name&&(e.locality=e.sublocality),t==="IE")return s.parseCityIreland(e);if(t==="TR")return s.parseCityTurkey(e);if(t==="FR")return s.parseCityFrance(e);let r=e.locality.long_name||e.postal_town.long_name||e.sublocality_level_1.long_name||e.administrative_area_level_3.long_name||"";return t==="BB"&&!r&&e.administrative_area_level_1.long_name&&(r=e.administrative_area_level_1.long_name),r}static parseCityIreland(e){return e.administrative_area_level_2.long_name&&e.administrative_area_level_2.long_name.indexOf(" City")>=0?e.administrative_area_level_2.long_name:e.locality.long_name||e.postal_town.long_name||e.sublocality_level_1.long_name||e.administrative_area_level_3.long_name||""}static parseCityTurkey(e){return e.locality.long_name||e.postal_town.long_name||e.sublocality_level_1.long_name||e.administrative_area_level_3.long_name||e.administrative_area_level_1.long_name||""}static parseCityFrance(e){return e.administrative_area_level_2.long_name==="Paris"?"Paris":e.locality.long_name||e.postal_town.long_name||e.sublocality_level_1.long_name||e.administrative_area_level_3.long_name||e.administrative_area_level_1.long_name||""}static parseZip(e,t,r){let o=t.postal_code.long_name||t.postal_code_prefix.long_name||"";return!r&&!o&&(o=s.findAnyZip(e)),o}static findAnyZip(e){for(const t of e)if(t.address_components){for(const r of t.address_components)if(r.types&&r.types[0]==="postal_code"&&r.short_name)return r.short_name}return""}static getGBCountry(e){const t=["England","Northern Ireland","Scotland","Wales"],r=e.administrative_area_level_1.long_name||"";for(const o of t)if(t.includes(r))return r;return null}static isGBSplitEnabled(){return window.geodir_split_uk===!0}}class l{constructor(e){this.mapProvider=e}async geocodeAddress(e,t=""){try{const r=t?{address:e,country:t}:e,o=await this.mapProvider.geocode(r);if(!o||o.length===0)throw new Error("No results found");const i=s.parseAddress(o,{mapType:this.mapProvider.getType()});if(this.mapProvider.getType()==="google"&&o[0].geometry){const a=o[0].geometry.location;return{lat:typeof a.lat=="function"?a.lat():a.lat,lng:typeof a.lng=="function"?a.lng():a.lng,address:i,rawResults:o}}if(this.mapProvider.getType()==="osm")return{lat:o[0].lat,lng:o[0].lon||o[0].lng,address:i,rawResults:o};throw new Error("Invalid geocode result format")}catch(r){throw console.error("Geocode error:",r),r}}async reverseGeocode(e,t,r={}){try{const o=await this.mapProvider.reverseGeocode(e,t);if(!o||o.length===0)throw new Error("Cannot determine address at this location");return{address:s.parseAddress(o,{mapType:this.mapProvider.getType()}),rawResults:o}}catch(o){throw console.error("Reverse geocode error:",o),o}}static buildAddressString(e,t=!1){let r="";if(t&&e.zip&&e.street)return`${e.street}, ${e.zip}`;const o=e.street||"",i=e.city||"",a=e.region||"",c=e.country||"",u=e.zip||"";return o&&o!==i&&o!==a&&o!==c&&o!==u&&(r+=o),e.countryISO==="GB"?(r=l.appendToAddress(r,i),r=l.appendToAddress(r,c)):(r=l.appendToAddress(r,i),r=l.appendToAddress(r,a),r=l.appendToAddress(r,c)),u&&(r=l.appendToAddress(r,u)),r=r.replace(/,+/g,","),r=r.replace(/(^,)|(,$)/g,"").trim(),r=r.replace(/,null,/g,","),r}static appendToAddress(e,t){return!t||t==="null"?e:e?`${e}, ${t}`:t}}class f{constructor(e,t,r={}){console.log("[AddressField] Constructor called with prefix:",e),console.log("[AddressField] mapProvider:",t),console.log("[AddressField] options:",r),this.prefix=e,this.mapProvider=t,this.options={lat:r.lat||"",lng:r.lng||"",mapZoom:r.mapZoom||12,defaultLocation:r.defaultLocation||{},isRestrict:r.isRestrict!==!1,autoChangeFields:r.autoChangeFields!==!1,autoChangePinMove:r.autoChangePinMove!==!1,minZoomLevel:r.minZoomLevel||5,...r},console.log("[AddressField] Merged options:",this.options),this.geocoding=new l(t),this.marker=null,this.userAddress=!1,this.isGeocoding=!1,(!this.options.lat||!this.options.lng)&&(console.log("[AddressField] No lat/lng, using defaults"),this.options.lat=this.options.defaultLocation.latitude||"",this.options.lng=this.options.defaultLocation.longitude||""),console.log("[AddressField] Final coordinates:",this.options.lat,this.options.lng),this.init()}async init(){console.log("[AddressField] init() called"),console.log("[AddressField] Initializing map provider...");const e=this.mapProvider.init();if(console.log("[AddressField] Map provider init result:",e),!e){console.error("[AddressField] Map initialization failed"),this.showMapError();return}console.log("[AddressField] Creating marker..."),this.createMarker(),console.log("[AddressField] Setting up listeners..."),this.setupAddressListeners(),this.setupMapListeners(),this.setupSetAddressButton(),console.log("[AddressField] Hiding loading indicator"),this.hideLoading(),console.log("[AddressField] Initialization complete!"),this.options.minZoomLevel>0&&this.mapProvider.addEventListener("zoom_changed",()=>{this.mapProvider.getZoom()<this.options.minZoomLevel&&this.mapProvider.setZoom(this.options.minZoomLevel)})}createMarker(){const e=parseFloat(this.options.lat)||0,t=parseFloat(this.options.lng)||0,r=this.options.markerIcon||"",o=this.options.markerSize||{w:20,h:34};this.marker=this.mapProvider.createMarker({lat:e,lng:t,id:"baseMarker",icon:r,draggable:!0,w:o.w,h:o.h}),this.setupMarkerListeners()}setupMarkerListeners(){this.marker&&(this.mapProvider.addMarkerListener(this.marker,"drag",()=>{this.updateMarkerPosition()}),this.mapProvider.addMarkerListener(this.marker,"dragend",()=>{this.mapProvider.panTo(this.getMarkerLat(),this.getMarkerLng()),this.options.autoChangePinMove&&this.reverseGeocodeMarkerPosition(),this.updateMarkerPosition()}))}setupMapListeners(){this.mapProvider.addEventListener("dragend",()=>{this.centerMarker(),this.options.autoChangePinMove&&this.reverseGeocodeMarkerPosition(),this.updateMarkerPosition()}),this.mapProvider.addEventListener("zoom_changed",()=>{this.updateMapZoom()})}setupAddressListeners(){const e=document.getElementById(`${this.prefix}street`);e&&e.addEventListener("keypress",()=>{this.userAddress=!0})}setupSetAddressButton(){const e=document.getElementById(`${this.prefix}set_address_button`);e&&e.addEventListener("click",()=>{this.codeAddress(!0)})}async codeAddress(e=!1){const t=this.buildAddressFromFields();if(!t)return;const r=this.getFieldValue("country",!0);try{const o=await this.geocoding.geocodeAddress(t,r);this.setMarkerPosition(o.lat,o.lng),this.mapProvider.setCenter(o.lat,o.lng),this.updateMarkerPosition(),await this.reverseGeocodeMarkerPosition()}catch(o){console.error("Geocoding failed:",o),alert(this.options.txt_geocode_error||"Geocode was not successful")}}async reverseGeocodeMarkerPosition(){if(!this.isGeocoding){this.isGeocoding=!0;try{const e=this.getMarkerLat(),t=this.getMarkerLng(),r=await this.geocoding.reverseGeocode(e,t);if(this.options.isRestrict){const o=(this.options.defaultLocation.city||"").toLowerCase();if((r.address.city||"").toLowerCase()!==o){alert(this.options.txt_city_restrict||`Please choose any address of the (${o}) city only.`),this.setMarkerPosition(this.options.defaultLocation.latitude,this.options.defaultLocation.longitude),this.mapProvider.setCenter(this.options.defaultLocation.latitude,this.options.defaultLocation.longitude),this.updateMarkerPosition(),this.isGeocoding=!1;return}}this.updateAddressFields(r.address)}catch(e){console.error("Reverse geocoding failed:",e)}finally{this.isGeocoding=!1}}}updateAddressFields(e){(!this.userAddress||!this.getFieldValue("street"))&&this.setFieldValue("street",e.street),e.street2&&(!this.userAddress||!this.getFieldValue("street2"))&&this.setFieldValue("street2",e.street2),this.setFieldValue("zip",e.zip),this.options.autoChangeFields&&(e.country&&this.setCountryValue(e.country,e.countryISO),e.region&&this.setFieldValue("region",e.region),e.city&&this.setFieldValue("city",e.city))}buildAddressFromFields(){const e={street:this.getFieldValue("street"),city:this.getFieldValue("city"),region:this.getFieldValue("region"),country:this.getFieldValue("country"),countryISO:this.getFieldValue("country",!0),zip:this.getFieldValue("zip")};return l.buildAddressString(e,this.options.isRestrict)}getFieldValue(e,t=!1){const r=document.getElementById(`${this.prefix}${e}`);if(!r)return"";if(t){if(e==="country"){const o=r.options[r.selectedIndex];return o&&o.dataset.country_code||""}return r.dataset.value||""}return r.value||""}setFieldValue(e,t){const r=document.getElementById(`${this.prefix}${e}`);!r||!t||(r.classList.contains("select2-hidden-accessible")?(r.value=t,r.dispatchEvent(new Event("change",{bubbles:!0})),r.dispatchEvent(new CustomEvent("change.select2",{bubbles:!0}))):r.value=t,r.dispatchEvent(new Event("blur",{bubbles:!0})))}setCountryValue(e,t){const r=document.getElementById(`${this.prefix}country`);if(!r)return;let o=r.querySelector(`option[data-country_code="${t}"]`);o||(o=Array.from(r.options).find(i=>i.value===e)),o&&(r.value=o.value,r.classList.contains("select2-hidden-accessible")&&r.dispatchEvent(new CustomEvent("change.select2",{bubbles:!0})))}updateMarkerPosition(){const e=document.querySelector('[name="latitude"]'),t=document.querySelector('[name="longitude"]');e&&(e.value=this.getMarkerLat(),e.dispatchEvent(new Event("change",{bubbles:!0}))),t&&(t.value=this.getMarkerLng(),t.dispatchEvent(new Event("change",{bubbles:!0})))}updateMapZoom(){const e=document.getElementById(`${this.prefix}mapzoom`);e&&(e.value=this.mapProvider.getZoom())}centerMarker(){const e=this.mapProvider.getCenter();this.setMarkerPosition(e.lat,e.lng)}getMarkerLat(){if(!this.marker)return 0;if(this.mapProvider.getType()==="google"){const e=this.marker.getPosition();return typeof e.lat=="function"?e.lat():e.lat}else return this.marker.getLatLng().lat}getMarkerLng(){if(!this.marker)return 0;if(this.mapProvider.getType()==="google"){const e=this.marker.getPosition();return typeof e.lng=="function"?e.lng():e.lng}else return this.marker.getLatLng().lng}setMarkerPosition(e,t){this.marker&&(this.mapProvider.getType()==="google"?this.marker.setPosition(new google.maps.LatLng(e,t)):this.marker.setLatLng(new L.LatLng(e,t)))}hideLoading(){const e=document.getElementById(`${this.prefix}map_loading_div`);e&&(e.style.display="none")}showMapError(){const e=document.getElementById(`${this.prefix}map_loading_div`),t=document.getElementById(`${this.prefix}map_nofound`),r=document.getElementById(`${this.prefix}map_notloaded`);e&&(e.style.display="none"),t&&(t.style.display="none"),r&&(r.style.display="block")}}const h={MapProvider:m,GoogleMapProvider:g,OSMMapProvider:p,MapFactory:n,Geocoding:l,CountryRules:s,AddressField:f,createMap(d,e={}){const t=n.create(d,e);return t&&t.init(),t},getAvailableProvider(){return n.getAvailableProvider()},isGoogleAvailable(){return n.isGoogleMapsAvailable()},isOSMAvailable(){return n.isOSMAvailable()}};window.GeoDir=window.GeoDir||{};window.GeoDir.Maps=h;console.log("[GeoDir Maps] Module loaded and attached to window.GeoDir.Maps");console.log("[GeoDir Maps] Available classes:",Object.keys(h));export{f as AddressField,s as CountryRules,l as Geocoding,g as GoogleMapProvider,n as MapFactory,m as MapProvider,p as OSMMapProvider,h as default};
//# sourceMappingURL=geodir-maps.js.map

	}
}(typeof self !== 'undefined' ? self : this, function() {
	// Module code will execute and set window.GeoDir.Maps
	return window.GeoDir && window.GeoDir.Maps;
}));