{"version":3,"file":"geodir-admin.js","sources":["../../resources/scripts/shared/rating-input.js?inline-for=%2Fhome%2Fstiofan%2Fwww%2Fhtml%2Fwp-content%2Fplugins%2Fgeodirectory%2Fresources%2Fscripts%2Fadmin.js","../../resources/scripts/admin.js"],"sourcesContent":["/**\n * Rating Input Handler\n *\n * Handles interactive star rating inputs for GeoDirectory reviews.\n * Used on both frontend comment forms and admin edit comment screens.\n *\n * @package GeoDirectory\n * @since 3.0.0\n */\n\n/**\n * Initialize rating input functionality.\n *\n * This function finds all `.gd-rating-input` elements and adds interactive\n * hover and click behaviors for star rating selection.\n *\n * @returns {void}\n */\nexport function initRatingInput() {\n\tconst ratingInputs = document.querySelectorAll('.gd-rating-input');\n\n\tif (!ratingInputs.length) {\n\t\treturn;\n\t}\n\n\tratingInputs.forEach((ratingInput) => {\n\t\tconst ratingWrap = ratingInput.querySelector('.gd-rating-wrap');\n\t\tconst foreground = ratingInput.querySelector('.gd-rating-foreground');\n\t\tconst ratingText = ratingInput.querySelector('.gd-rating-text');\n\t\tconst hiddenInput = ratingInput.querySelector('input[type=\"hidden\"]');\n\t\t// Get stars from foreground for count and titles\n\t\tconst stars = ratingInput.querySelectorAll('.gd-rating-foreground > i, .gd-rating-foreground > svg, .gd-rating-foreground > img');\n\n\t\tif (!ratingWrap || !foreground || !ratingText || !hiddenInput || !stars.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst totalStars = stars.length;\n\t\tconst currentValue = parseFloat(hiddenInput.value) || 0;\n\n\t\t// Make foreground not block mouse events\n\t\tforeground.style.pointerEvents = 'none';\n\n\t\t// Set initial state if value exists\n\t\tif (currentValue > 0) {\n\t\t\tconst percent = (currentValue / totalStars) * 100;\n\t\t\tforeground.style.width = `${percent}%`;\n\n\t\t\tconst starIndex = Math.floor(currentValue) - 1;\n\t\t\tif (stars[starIndex]) {\n\t\t\t\tratingText.textContent = stars[starIndex].getAttribute('title') || '';\n\t\t\t}\n\t\t}\n\n\t\t// Track if rating has been set by click\n\t\tlet ratingSet = false;\n\n\t\t// Mouse move on the rating wrap - calculate which star is hovered\n\t\tratingWrap.addEventListener('mousemove', (e) => {\n\t\t\tconst rect = ratingWrap.getBoundingClientRect();\n\t\t\tconst x = e.clientX - rect.left;\n\t\t\tconst starWidth = rect.width / totalStars;\n\t\t\tconst hoveredIndex = Math.floor(x / starWidth);\n\t\t\tconst rating = Math.min(Math.max(hoveredIndex + 1, 1), totalStars);\n\t\t\tconst percent = (rating / totalStars) * 100;\n\n\t\t\t// Show preview\n\t\t\tforeground.style.width = `${percent}%`;\n\n\t\t\tif (stars[rating - 1]) {\n\t\t\t\tratingText.textContent = stars[rating - 1].getAttribute('title') || '';\n\t\t\t}\n\n\t\t\tratingSet = false;\n\t\t});\n\n\t\t// Mouse leave - restore to saved value\n\t\tratingWrap.addEventListener('mouseleave', () => {\n\t\t\tif (!ratingSet) {\n\t\t\t\tconst currentRating = parseFloat(hiddenInput.value) || 0;\n\t\t\t\tconst originalPercent = (currentRating / totalStars) * 100;\n\t\t\t\tforeground.style.width = `${originalPercent}%`;\n\n\t\t\t\tif (currentRating > 0) {\n\t\t\t\t\tconst savedStarIndex = Math.floor(currentRating) - 1;\n\t\t\t\t\tif (stars[savedStarIndex]) {\n\t\t\t\t\t\tratingText.textContent = stars[savedStarIndex].getAttribute('title') || '';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tratingText.textContent = ratingText.getAttribute('data-title') || '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tratingSet = false;\n\t\t});\n\n\t\t// Click - set rating permanently\n\t\tratingWrap.addEventListener('click', (e) => {\n\t\t\tconst rect = ratingWrap.getBoundingClientRect();\n\t\t\tconst x = e.clientX - rect.left;\n\t\t\tconst starWidth = rect.width / totalStars;\n\t\t\tconst clickedIndex = Math.floor(x / starWidth);\n\t\t\tconst rating = Math.min(Math.max(clickedIndex + 1, 1), totalStars);\n\t\t\tconst percent = (rating / totalStars) * 100;\n\n\t\t\thiddenInput.value = rating;\n\t\t\tforeground.style.width = `${percent}%`;\n\n\t\t\tif (stars[rating - 1]) {\n\t\t\t\tratingText.textContent = stars[rating - 1].getAttribute('title') || '';\n\t\t\t}\n\n\t\t\tratingSet = true;\n\t\t});\n\t});\n}\n","/**\n * GeoDirectory Admin Script\n * Handles admin dashboard interactions.\n */\n\nimport { initRatingInput } from './shared/rating-input.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n\t'use strict';\n\n\tconsole.log('GeoDirectory: Admin loaded');\n\n\t// Initialize rating input (for edit comment screens)\n\tinitRatingInput();\n\twindow.GeoDir = window.GeoDir || {};\n\twindow.GeoDir.initRatingInput = initRatingInput;\n\tconsole.log('GeoDirectory: Rating input initialized');\n});\n"],"names":["initRatingInput","ratingInputs","ratingInput","ratingWrap","foreground","ratingText","hiddenInput","stars","totalStars","currentValue","percent","starIndex","ratingSet","e","rect","x","starWidth","hoveredIndex","rating","currentRating","originalPercent","savedStarIndex","clickedIndex"],"mappings":"AAkBO,SAASA,GAAkB,CACjC,MAAMC,EAAe,SAAS,iBAAiB,kBAAkB,EAE5DA,EAAa,QAIlBA,EAAa,QAASC,GAAgB,CACrC,MAAMC,EAAaD,EAAY,cAAc,iBAAiB,EACxDE,EAAaF,EAAY,cAAc,uBAAuB,EAC9DG,EAAaH,EAAY,cAAc,iBAAiB,EACxDI,EAAcJ,EAAY,cAAc,sBAAsB,EAE9DK,EAAQL,EAAY,iBAAiB,qFAAqF,EAEhI,GAAI,CAACC,GAAc,CAACC,GAAc,CAACC,GAAc,CAACC,GAAe,CAACC,EAAM,OACvE,OAGD,MAAMC,EAAaD,EAAM,OACnBE,EAAe,WAAWH,EAAY,KAAK,GAAK,EAMtD,GAHAF,EAAW,MAAM,cAAgB,OAG7BK,EAAe,EAAG,CACrB,MAAMC,EAAWD,EAAeD,EAAc,IAC9CJ,EAAW,MAAM,MAAQ,GAAGM,CAAO,IAEnC,MAAMC,EAAY,KAAK,MAAMF,CAAY,EAAI,EACzCF,EAAMI,CAAS,IAClBN,EAAW,YAAcE,EAAMI,CAAS,EAAE,aAAa,OAAO,GAAK,GAErE,CAGA,IAAIC,EAAY,GAGhBT,EAAW,iBAAiB,YAAcU,GAAM,CAC/C,MAAMC,EAAOX,EAAW,sBAAqB,EACvCY,EAAIF,EAAE,QAAUC,EAAK,KACrBE,EAAYF,EAAK,MAAQN,EACzBS,EAAe,KAAK,MAAMF,EAAIC,CAAS,EACvCE,EAAS,KAAK,IAAI,KAAK,IAAID,EAAe,EAAG,CAAC,EAAGT,CAAU,EAC3DE,EAAWQ,EAASV,EAAc,IAGxCJ,EAAW,MAAM,MAAQ,GAAGM,CAAO,IAE/BH,EAAMW,EAAS,CAAC,IACnBb,EAAW,YAAcE,EAAMW,EAAS,CAAC,EAAE,aAAa,OAAO,GAAK,IAGrEN,EAAY,EACb,CAAC,EAGDT,EAAW,iBAAiB,aAAc,IAAM,CAC/C,GAAI,CAACS,EAAW,CACf,MAAMO,EAAgB,WAAWb,EAAY,KAAK,GAAK,EACjDc,EAAmBD,EAAgBX,EAAc,IAGvD,GAFAJ,EAAW,MAAM,MAAQ,GAAGgB,CAAe,IAEvCD,EAAgB,EAAG,CACtB,MAAME,EAAiB,KAAK,MAAMF,CAAa,EAAI,EAC/CZ,EAAMc,CAAc,IACvBhB,EAAW,YAAcE,EAAMc,CAAc,EAAE,aAAa,OAAO,GAAK,GAE1E,MACChB,EAAW,YAAcA,EAAW,aAAa,YAAY,GAAK,EAEpE,CAEAO,EAAY,EACb,CAAC,EAGDT,EAAW,iBAAiB,QAAUU,GAAM,CAC3C,MAAMC,EAAOX,EAAW,sBAAqB,EACvCY,EAAIF,EAAE,QAAUC,EAAK,KACrBE,EAAYF,EAAK,MAAQN,EACzBc,EAAe,KAAK,MAAMP,EAAIC,CAAS,EACvCE,EAAS,KAAK,IAAI,KAAK,IAAII,EAAe,EAAG,CAAC,EAAGd,CAAU,EAC3DE,EAAWQ,EAASV,EAAc,IAExCF,EAAY,MAAQY,EACpBd,EAAW,MAAM,MAAQ,GAAGM,CAAO,IAE/BH,EAAMW,EAAS,CAAC,IACnBb,EAAW,YAAcE,EAAMW,EAAS,CAAC,EAAE,aAAa,OAAO,GAAK,IAGrEN,EAAY,EACb,CAAC,CACF,CAAC,CACF,CC5GA,SAAS,iBAAiB,mBAAoB,IAAM,CAGnD,QAAQ,IAAI,4BAA4B,EAGxCZ,EAAe,EACf,OAAO,OAAS,OAAO,QAAU,CAAA,EACjC,OAAO,OAAO,gBAAkBA,EAChC,QAAQ,IAAI,wCAAwC,CACrD,CAAC"}